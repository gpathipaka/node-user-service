import json
import boto3
s3 = boto3.resource('s3')

def lambda_handler(event, context):
    print('@'*50)
    count = 1
    print("DUMP>>>>>>", event)
    for record in event['Records']:
        bucket = record['s3']['bucket']['name']
        key = record['s3']['object']['key']
        print('Bucket ', bucket)
        print('Key ', key)
        print('COUNT -> ', ++count)
        file_content = s3.Object(bucket, key).get()['Body'].read().decode('utf-8')
        data = json.loads(file_content)
        print('File Content -> ', data)
              
    
    print('*'*50)
